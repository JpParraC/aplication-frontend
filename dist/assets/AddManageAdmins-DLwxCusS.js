import{z as V,r as t,j as e,f as o}from"./index-ffYVKfzY.js";import{C as p}from"./index.esm-DxGkv9hs.js";import{$ as f}from"./DefaultLayout-1dw4Iart.js";/* empty css               */import{T}from"./Table-BNWZN0Px.js";import{c as R}from"./cil-pen-53d2I-C-.js";import{c as P}from"./cil-trash-CBbKHhHb.js";import{C as b,a as C,b as y,c as S,d as A}from"./CModalTitle-Dv47fJq6.js";import"./cil-user-Ddrdy7PS.js";import"./index-C9dK0-s5.js";import"./ThemeProvider-BV5dC5GT.js";import"./CCloseButton-iY6CcsDx.js";const re=()=>{const{user:i}=V(),[h,m]=t.useState([]),[c,E]=t.useState(""),[g,n]=t.useState(null),[x,d]=t.useState(""),[a,u]=t.useState({id_staff:"",role:1}),[z,$]=t.useState(null),[B,F]=t.useState(!1),[v,l]=t.useState(!1),[H,M]=t.useState(!1),[O,N]=t.useState(null),[G,J]=t.useState(!1);t.useEffect(()=>{_()},[]);const _=async()=>{try{const s=await fetch("http://localhost:5000/api/admins/all-users");if(s.ok){const r=await s.json();m(r)}else console.error("Error obteniendo admins")}catch(s){console.error("Error en la solicitud:",s)}},k=async()=>{try{const s=await fetch(`http://localhost:5000/api/staff/${c}`);if(s.ok){const r=await s.json();n(r),u({id_staff:c,role:1}),d("")}else n(null),d("El ID de staff no existe.")}catch(s){console.error("Error verificando el staff:",s),d("Hubo un error al verificar el ID.")}},D=async()=>{try{if((await fetch(`http://localhost:5000/api/staff/${a.id_staff}`)).ok){const r=prompt("Ingrese una contraseña para el nuevo usuario:");if(!r){alert("Debe ingresar una contraseña.");return}const I={password:r,role_id:a.role,staff_id:a.id_staff},j=await fetch("http://localhost:5000/api/admins",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)});if(j.ok){const w=await j.json();m([...h,w]),l(!1)}else console.error("Error al crear el usuario en users.")}else alert("El ID del staff no existe.")}catch(s){console.error("Error en la inserción:",s)}};return e.jsxs("div",{className:"container",children:[e.jsx("h2",{className:"mb-3",children:"Manage Administrators"}),e.jsx("div",{className:"text-start",children:f(i,"manage_admins")&&e.jsx(o,{color:"success",onClick:()=>l(!0),className:"px-4",children:"Add Administrator"})}),e.jsx("div",{className:"table-responsive mt-3",children:e.jsxs(T,{striped:!0,bordered:!0,hover:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-center",children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"First Name"}),e.jsx("th",{children:"Last Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Phone Number"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:h.map(s=>e.jsxs("tr",{className:"text-center",children:[e.jsx("td",{children:s.staff_id}),e.jsx("td",{children:s.name_staff}),e.jsx("td",{children:s.lastname_staff}),e.jsx("td",{children:s.email_staff}),e.jsx("td",{children:s.phone}),e.jsx("td",{children:s.staff_role_name}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"0.5rem"},children:[f(i,"manage_admins")&&e.jsx("button",{className:"btn btn-link",onClick:()=>handleEditAdmin(s.id),title:"Edit",children:e.jsx(p,{icon:R,style:{fontSize:"1.5rem",color:"orange"}})}),f(i,"manage_admins")&&e.jsx("button",{className:"btn btn-link",onClick:()=>{N(s),M(!0)},title:"Delete",children:e.jsx(p,{icon:P,style:{fontSize:"1.5rem",color:"red"}})})]})})]},s.staff_id))})]})}),e.jsxs(b,{visible:v,onClose:()=>l(!1),children:[e.jsx(C,{children:e.jsx(y,{children:"Verificar ID de Staff"})}),e.jsxs(S,{children:[e.jsx("input",{type:"text",className:"form-control",placeholder:"Ingrese ID de Staff",value:c,onChange:s=>E(s.target.value)}),x&&e.jsx("p",{style:{color:"red"},children:x})]}),e.jsxs(A,{children:[e.jsx(o,{color:"secondary",onClick:()=>l(!1),children:"Cancelar"}),e.jsx(o,{color:"primary",onClick:k,children:"Verificar"})]})]}),g&&e.jsxs(b,{visible:!0,onClose:()=>n(null),children:[e.jsx(C,{children:e.jsx(y,{children:"Asignar Rol"})}),e.jsx(S,{children:e.jsxs("select",{className:"form-control",value:a.role,onChange:s=>u({...a,role:parseInt(s.target.value)}),children:[e.jsx("option",{value:"1",children:"Administrador"}),e.jsx("option",{value:"2",children:"Recepcionista"})]})}),e.jsxs(A,{children:[e.jsx(o,{color:"secondary",onClick:()=>n(null),children:"Cancelar"}),e.jsx(o,{color:"success",onClick:D,children:"Guardar"})]})]})]})};export{re as default};
