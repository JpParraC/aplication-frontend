import{r as f,q as v,j as e,E as C,F as _,K as s,I as r,f as p}from"./index-ffYVKfzY.js";/* empty css               */import{a0 as N}from"./DefaultLayout-1dw4Iart.js";import{C as u}from"./CFormSelect-Bo4w6EQM.js";import{C as y,a as S,b as I,c as E,d as P}from"./CModalTitle-Dv47fJq6.js";import"./index.esm-DxGkv9hs.js";import"./cil-user-Ddrdy7PS.js";import"./CCloseButton-iY6CcsDx.js";const R=()=>{const[j,h]=f.useState("default-avatar.png"),[a,m]=f.useState({id_staff:"",name_staff:"",lastname_staff:"",rol_id:"",email_staff:"",phone:""}),[x,d]=f.useState(!1);f.useEffect(()=>{const o=localStorage.getItem("user"),t=localStorage.getItem("gen"),n=localStorage.getItem("token");if(o){const l=JSON.parse(o);m({id_staff:l.staff_id,name_staff:l.name,lastname_staff:l.lastname,rol_id:l.role_id,email_staff:l.email,phone:l.phone})}let c=t?t.toLowerCase():"";if(!c&&n){const l=v(n);c=l.gen?l.gen.toLowerCase():""}c==="m"?h("./src/assets/images/avatars/avatarman.png"):c==="f"&&h("./src/assets/images/avatars/avatarfemale.png")},[]);const i=o=>{const{name:t,value:n}=o.target;m(c=>({...c,[t]:n}))},g=async()=>{try{const o=localStorage.getItem("token"),t=await fetch(`http://localhost:5000/api/admins/${a.id_staff}`,{method:"PUT",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify(a)});if(t.ok){const n=await t.json();localStorage.setItem("user",JSON.stringify(n)),m(n),d(!1),alert("Profile updated successfully!")}else console.error("Error updating profile"),alert("Failed to update profile.")}catch(o){console.error("Error:",o),alert("An error occurred while updating the profile.")}};return e.jsxs(C,{className:"profile-card",children:[e.jsx(_,{className:"profile-body",children:e.jsxs("div",{className:"profile-container",children:[e.jsx(N,{className:"profile-avatar",children:e.jsx("img",{src:j,alt:"Profile Icon",className:"avatar-img"})}),e.jsxs("div",{className:"profile-info",children:[e.jsx(s,{children:"ID"}),e.jsx(r,{className:"profile-input",value:a.id_staff,readOnly:!0})]}),e.jsxs("div",{className:"profile-info",children:[e.jsx(s,{children:"First Name"}),e.jsx(r,{className:"profile-input",value:a.name_staff,readOnly:!0})]}),e.jsxs("div",{className:"profile-info",children:[e.jsx(s,{children:"Last Name"}),e.jsx(r,{className:"profile-input",value:a.lastname_staff,readOnly:!0})]}),e.jsxs("div",{className:"profile-info",children:[e.jsx(s,{children:"Role"}),e.jsxs(u,{className:"profile-input",name:"rol_id",value:a.rol_id||"",onChange:i,children:[e.jsx("option",{value:"1",children:"Administrator"}),e.jsx("option",{value:"2",children:"Receptionist"})]})]}),e.jsxs("div",{className:"profile-info",children:[e.jsx(s,{children:"Email"}),e.jsx(r,{className:"profile-input",value:a.email_staff,readOnly:!0})]}),e.jsxs("div",{className:"profile-info",children:[e.jsx(s,{children:"Phone"}),e.jsx(r,{className:"profile-input",value:a.phone,readOnly:!0})]}),e.jsx(p,{className:"buttonnn",color:"primary",onClick:()=>d(!0),children:"Edit Profile"})]})}),e.jsxs(y,{visible:x,onClose:()=>d(!1),children:[e.jsx(S,{children:e.jsx(I,{children:"Edit Profile"})}),e.jsxs(E,{children:[e.jsx(s,{children:"First Name"}),e.jsx(r,{name:"name_staff",value:a.name_staff,onChange:i}),e.jsx(s,{children:"Last Name"}),e.jsx(r,{name:"lastname_staff",value:a.lastname_staff,onChange:i}),e.jsx(s,{children:"Role"}),e.jsxs(u,{name:"rol_id",value:a.rol_id||"",onChange:i,children:[e.jsx("option",{value:"1",children:"Administrator"}),e.jsx("option",{value:"2",children:"Receptionist"})]}),e.jsx(s,{children:"Email"}),e.jsx(r,{name:"email_staff",value:a.email_staff,onChange:i}),e.jsx(s,{children:"Phone"}),e.jsx(r,{name:"phone",value:a.phone,onChange:i})]}),e.jsxs(P,{children:[e.jsx(p,{color:"secondary",onClick:()=>d(!1),children:"Cancel"}),e.jsx(p,{color:"primary",onClick:g,children:"Save Changes"})]})]})]})};export{R as default};
