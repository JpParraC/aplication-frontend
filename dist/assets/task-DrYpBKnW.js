import{r as l,j as e,J as m}from"./index-ffYVKfzY.js";import{C}from"./index.esm-DxGkv9hs.js";import{M as c,B as o}from"./Modal-DHu8A-az.js";import{F as i}from"./Form-CqvpA1Dk.js";import{T as I}from"./Table-BNWZN0Px.js";import{c as N}from"./cil-pen-53d2I-C-.js";import{c as w}from"./cil-trash-CBbKHhHb.js";import{c as H}from"./cil-check-Dqg5Ixbd.js";import"./index-C9dK0-s5.js";import"./ThemeProvider-BV5dC5GT.js";import"./hasClass-DoSno_Ds.js";const O=({show:p,handleClose:h,task:s,handleSave:T,staff:g})=>{const[y,k]=l.useState(s?s.description:"cleaning"),[d,v]=l.useState(s?s.status:"pending"),[f,A]=l.useState(s?s.staffId:""),[x,u]=l.useState(s?s.createdAt:new Date().toISOString().split("T")[0]),S=[{value:"cleaning",label:"Cleaning"},{value:"room_service",label:"Room Service"},{value:"maintenance",label:"Maintenance"},{value:"check_in",label:"Check-in Assistance"},{value:"check_out",label:"Check-out Assistance"},{value:"concierge",label:"Concierge Service"},{value:"event_management",label:"Event Management"}];l.useEffect(()=>{s&&(k(s.description),v(s.status),A(s.staffId),u(s.createdAt))},[s]);const D=()=>{const r={id:s==null?void 0:s.id,description:y,status:d,staffId:f,createdAt:x};T(r)};return e.jsxs(c,{show:p,onHide:h,children:[e.jsx(c.Header,{closeButton:!0,children:e.jsx(c.Title,{children:s?"Edit Task":"Add Task"})}),e.jsx(c.Body,{children:e.jsxs(i,{children:[e.jsxs(i.Group,{controlId:"taskDescription",children:[e.jsx(i.Label,{children:"Description"}),e.jsx(i.Control,{as:"select",value:y,onChange:r=>k(r.target.value),children:S.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})]}),e.jsxs(i.Group,{controlId:"taskStatus",children:[e.jsx(i.Label,{children:"Status"}),e.jsxs(i.Control,{as:"select",value:d,onChange:r=>v(r.target.value),children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"completed",children:"Completed"})]})]}),e.jsxs(i.Group,{controlId:"assignedStaff",children:[e.jsx(i.Label,{children:"Assigned Staff"}),e.jsxs(i.Control,{as:"select",value:f,onChange:r=>A(r.target.value),children:[e.jsx("option",{value:"",children:"Select Staff"}),g.map(r=>e.jsxs("option",{value:r.id,children:[r.firstName," ",r.lastName]},r.id))]})]}),!s&&e.jsxs(i.Group,{controlId:"taskCreatedAt",children:[e.jsx(i.Label,{children:"Created At"}),e.jsx(i.Control,{type:"date",value:x,onChange:()=>{},readOnly:!0})]})]})}),e.jsxs(c.Footer,{children:[e.jsx(o,{variant:"secondary",onClick:h,children:"Cancel"}),e.jsx(o,{variant:"primary",onClick:D,children:"Save"})]})]})},Y=()=>{const[p,h]=l.useState([]),[s,T]=l.useState([]),[g,y]=l.useState([]),[k,d]=l.useState(!1),[v,f]=l.useState(null),[A,x]=l.useState(!1),[u,S]=l.useState(null),[D,r]=l.useState(""),[b,E]=l.useState("");l.useEffect(()=>{m.get("http://localhost:3001/tasks").then(t=>{const n=t.data;h(n.sort((a,j)=>new Date(j.createdAt)-new Date(a.createdAt))),T(n.filter(a=>a.status==="Completed"))}).catch(t=>console.error("Error fetching tasks:",t)),m.get("http://localhost:3001/staff").then(t=>{y(t.data)}).catch(t=>console.error("Error fetching staff:",t))},[]);const F=p.filter(t=>{const n=g.find(j=>j.id===t.staffId),a=n?`${n.firstName} ${n.lastName}`:"";return t.id.toString().includes(D)&&a.toLowerCase().includes(b.toLowerCase())}),L=()=>{f(null),d(!0)},M=()=>{d(!1)},$=t=>{m.post("http://localhost:3001/tasks",t).then(n=>{h([n.data,...p]),d(!1)}).catch(n=>console.error("Error adding task:",n))},B=t=>{m.put(`http://localhost:3001/tasks/${t.id}`,t).then(n=>{const a=p.map(j=>j.id===t.id?n.data:j);h(a),d(!1)}).catch(n=>console.error("Error updating task:",n))},z=()=>{u&&m.delete(`http://localhost:3001/tasks/${u.id}`).then(()=>{h(p.filter(t=>t.id!==u.id)),x(!1),S(null)}).catch(t=>console.error("Error deleting task:",t))},G=t=>{const n={...t,status:"Completed",completedAt:new Date().toISOString()};m.put(`http://localhost:3001/tasks/${t.id}`,n).then(a=>{h(p.filter(j=>j.id!==t.id)),T([a.data,...s])}).catch(a=>console.error("Error marking task as completed:",a))};return e.jsxs("div",{children:[e.jsx("h2",{children:"Task Management"}),e.jsx(o,{variant:"dark",onClick:L,children:"Add Task"}),e.jsxs("div",{style:{marginTop:"10px"},children:[e.jsx("input",{type:"text",placeholder:"Filter by Task ID",value:D,onChange:t=>r(t.target.value),style:{marginRight:"10px",padding:"5px"}}),e.jsx("input",{type:"text",placeholder:"Filter by Staff Name",value:b,onChange:t=>E(t.target.value),style:{padding:"5px"}})]}),e.jsx("div",{className:"table-responsive mt-3",children:e.jsxs(I,{striped:!0,bordered:!0,hover:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-center",children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Description"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Assigned Staff"}),e.jsx("th",{children:"Staff ID"}),e.jsx("th",{children:"Created At"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:F.map(t=>{const n=g.find(a=>a.id===t.staffId);return e.jsxs("tr",{className:"text-center",children:[e.jsx("td",{children:t.id}),e.jsx("td",{children:t.description}),e.jsx("td",{children:t.status}),e.jsx("td",{children:n?`${n.firstName} ${n.lastName}`:"Not Assigned"}),e.jsx("td",{children:t.staffId}),e.jsx("td",{children:t.createdAt}),e.jsx("td",{className:"d-flex justify-content-center",children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx(o,{variant:"link",onClick:()=>{f(t),d(!0)},title:"Edit",children:e.jsx(C,{icon:N,style:{fontSize:"1.5rem",color:"orange"}})}),e.jsx(o,{variant:"link",onClick:()=>{S(t),x(!0)},title:"Delete",children:e.jsx(C,{icon:w,style:{fontSize:"1.5rem",color:"red"}})}),e.jsx(o,{variant:"link",onClick:()=>G(t),title:"Mark as Completed",children:e.jsx(C,{icon:H,style:{fontSize:"1.5rem",color:"green"}})})]})})]},t.id)})})]})}),e.jsx("h2",{children:"Completed Tasks"}),e.jsx("div",{className:"table-responsive mt-3",children:e.jsxs(I,{striped:!0,bordered:!0,hover:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-center",children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Description"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Completed At"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:s.map(t=>e.jsxs("tr",{className:"text-center",children:[e.jsx("td",{children:t.id}),e.jsx("td",{children:t.description}),e.jsx("td",{children:t.status}),e.jsx("td",{children:new Date(t.completedAt).toLocaleString()}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center"},children:[e.jsx(o,{variant:"link",onClick:()=>{f(t),d(!0)},title:"Edit",children:e.jsx(C,{icon:N,style:{fontSize:"1.5rem",color:"orange"}})}),e.jsx(o,{variant:"link",onClick:()=>{S(t),x(!0)},title:"Delete",children:e.jsx(C,{icon:w,style:{fontSize:"1.5rem",color:"red"}})})]})})]},t.id))})]})}),e.jsx(O,{show:k,handleClose:M,task:v,handleSave:v?B:$,staff:g}),e.jsxs(c,{show:A,onHide:()=>x(!1),children:[e.jsx(c.Header,{closeButton:!0,children:e.jsx(c.Title,{children:"Confirm Deletion"})}),e.jsxs(c.Body,{children:["Are you sure you want to delete task ",e.jsx("strong",{children:u==null?void 0:u.description}),"?"]}),e.jsxs(c.Footer,{children:[e.jsx(o,{variant:"secondary",onClick:()=>x(!1),children:"Cancel"}),e.jsx(o,{variant:"danger",onClick:z,children:"Delete"})]})]})]})};export{Y as default};
