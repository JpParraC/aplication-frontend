import{r as s,j as e,J as b}from"./index-ffYVKfzY.js";import{M as l,B as d}from"./Modal-DHu8A-az.js";import{F as r}from"./Form-CqvpA1Dk.js";import{R as V}from"./reservationform-CsX-nHLZ.js";import{C as M}from"./index.esm-DxGkv9hs.js";/* empty css               */import{u as A,w as W}from"./xlsx-CwztvpuY.js";import{T as X}from"./Table-BNWZN0Px.js";import{c as Z}from"./cil-pen-53d2I-C-.js";import{c as ee}from"./cil-trash-CBbKHhHb.js";import{y as te}from"./DefaultLayout-1dw4Iart.js";import"./index-C9dK0-s5.js";import"./ThemeProvider-BV5dC5GT.js";import"./hasClass-DoSno_Ds.js";import"./cil-user-Ddrdy7PS.js";const re=({show:j,handleClose:m,handleSave:B,client:a})=>{const[v,c]=s.useState(""),[g,h]=s.useState(""),[N,x]=s.useState(""),[S,C]=s.useState(""),[p,w]=s.useState(""),[k,y]=s.useState(""),[E,I]=s.useState(""),[_,u]=s.useState(""),[F,f]=s.useState("");s.useEffect(()=>{console.log(a),a?(c(a.id_guest||""),h(a.first_name||""),x(a.middle_name||""),C(a.first_lastname||""),w(a.email||""),y(a.date_ofbirth||""),I(a.phone_number||""),u(a.number_persons||""),f(a.nationality||"")):G()},[a]);const G=()=>{c(""),h(""),x(""),C(""),w(""),y(""),I(""),u(""),f("")},D=o=>{o.preventDefault(),B({id_guest:v,first_name:g,first_lastname:S,middle_name:N,email:p,date_ofbirth:k,phone_number:E,number_persons:_,nationality:F}),G(),m()};return e.jsxs(l,{show:j,onHide:m,children:[e.jsx(l.Header,{closeButton:!0,children:e.jsx(l.Title,{children:a?"Edit Client":"Add Client"})}),e.jsx(l.Body,{children:e.jsxs(r,{onSubmit:D,children:[e.jsxs(r.Group,{controlId:"formIdGuest",children:[e.jsx(r.Label,{children:"ID Guest"}),e.jsx(r.Control,{type:"text",placeholder:"Enter ID Guest",value:v,onChange:o=>c(o.target.value),required:!0,readOnly:!!a})]}),e.jsxs(r.Group,{controlId:"formFirstName",children:[e.jsx(r.Label,{children:"First Name"}),e.jsx(r.Control,{type:"text",placeholder:"Enter first name",value:g,onChange:o=>h(o.target.value),required:!0})]}),e.jsxs(r.Group,{controlId:"formMiddleName",children:[e.jsx(r.Label,{children:"Middle Name"}),e.jsx(r.Control,{type:"text",placeholder:"Enter middle name",value:N,onChange:o=>x(o.target.value)})]}),e.jsxs(r.Group,{controlId:"formLastName",children:[e.jsx(r.Label,{children:"Last Name"}),e.jsx(r.Control,{type:"text",placeholder:"Enter last name",value:S,onChange:o=>C(o.target.value),required:!0})]}),e.jsxs(r.Group,{controlId:"formEmail",children:[e.jsx(r.Label,{children:"Email"}),e.jsx(r.Control,{type:"email",placeholder:"Enter email",value:p,onChange:o=>w(o.target.value),required:!0})]}),e.jsxs(r.Group,{controlId:"formDateOfBirth",children:[e.jsx(r.Label,{children:"Date of Birth"}),e.jsx(r.Control,{type:"date",placeholder:"Enter date of birth",value:k,onChange:o=>y(o.target.value),required:!0})]}),e.jsxs(r.Group,{controlId:"formPhoneNumber",children:[e.jsx(r.Label,{children:"Phone Number"}),e.jsx(r.Control,{type:"text",placeholder:"Enter phone number",value:E,onChange:o=>I(o.target.value),required:!0})]}),e.jsxs(r.Group,{controlId:"formNumberPersons",children:[e.jsx(r.Label,{children:"Number of Persons of Habitation"}),e.jsx(r.Control,{type:"number",placeholder:"Enter number of persons in habitation",value:_,onChange:o=>u(o.target.value),required:!0})]}),e.jsxs(r.Group,{controlId:"formNationality",children:[e.jsx(r.Label,{children:"Nationality"}),e.jsx(r.Control,{type:"text",placeholder:"Enter nationality",value:F,onChange:o=>f(o.target.value),required:!0})]}),e.jsx("div",{className:"d-flex justify-content-center mt-3",children:e.jsx(d,{variant:"primary",type:"submit",className:"mb-3",children:"Save"})})]})})]})},Ce=()=>{const[j,m]=s.useState([]),[B,a]=s.useState([]),[v,c]=s.useState(!1),[g,h]=s.useState(!1),[N,x]=s.useState(!1),[S,C]=s.useState(null),[p,w]=s.useState(null),[k,y]=s.useState(!1),[E,I]=s.useState(""),[_,u]=s.useState(!1),[F,f]=s.useState(!1),[G,D]=s.useState(!1),[o,q]=s.useState(null),P=async()=>{try{const L=(await b.get("http://localhost:5000/api/users/")).data.map(i=>({id:i.id,idGuest:i.id_guest,firstName:i.first_name,middleName:i.middle_name,lastName:i.first_lastname,email:i.email,dateOfBirth:i.date_ofbirth,phoneNumber:i.phone_number,numberPersons:i.number_persons,nationality:i.nationality}));m(L)}catch(t){console.error("Error loading clients:",t),alert("An error occurred while fetching clients.")}},O=async()=>{try{const t=await b.get("http://localhost:5000/api/reservations/");a(t.data)}catch(t){console.error("Error loading reservations:",t),alert("An error occurred while fetching reservations.")}},H=()=>{const t=A.json_to_sheet(j),n=A.book_new();A.book_append_sheet(n,t,"Clients"),W(n,"Clients_List.xlsx")},T=j.filter(t=>{var n;return((n=t.idGuest)==null?void 0:n.toString().includes(E))||t.idGuest===0});s.useEffect(()=>{P(),O()},[]);const z=()=>{C(null),c(!0)},Y=()=>{c(!1)},$=t=>{console.log("Selected Client: ",t),w(t),k?h(!0):x(!0)},R=t=>{x(!1),t?(y(!0),console.log("Client checked-in, opening ReservationForm..."),h(!0)):alert("Client must be checked in to make a reservation.")},J=async t=>{try{const n=await b.post("http://localhost:5000/api/users/",t);m(L=>[...L,n.data]),c(!1),D(!0),P()}catch(n){console.error("Error adding client:",n),alert("An error occurred while adding the client.")}},K=async t=>{try{const n=await b.put(`http://localhost:5000/api/users/${t.id}`,t),L=j.map(i=>i.id===t.id?n.data:i);m(L),c(!1)}catch(n){console.error("Error updating client:",n),alert("An error occurred while updating the client.")}},Q=async()=>{try{await b.delete(`http://localhost:5000/api/users/${o}`),m(j.filter(t=>t.id!==o)),u(!1),f(!0)}catch(t){console.error("Error deleting client:",t),alert("An error occurred while deleting the client.")}},U=async t=>{if(console.log("Selected Client: ",p),k&&p){t.clientId=p.idGuest;try{const n=await b.post("http://localhost:5000/api/reservations/",t);a([...B,n.data]),h(!1),y(!1)}catch(n){console.error("Error adding reservation:",n),alert("An error occurred while adding the reservation.")}}else alert("Client must be checked in before adding a reservation.")};return e.jsxs("div",{children:[e.jsx("h2",{className:"bl",children:"Client Management"}),e.jsx(d,{className:"button-blue",onClick:z,children:"Add Client"}),e.jsx("input",{type:"number",placeholder:"Filter by Client ID",value:E,onChange:t=>I(t.target.value),className:"search-input",style:{marginLeft:"10px",padding:"5px"},min:"0",max:"999999",step:"1"}),e.jsx(d,{variant:"success",onClick:H,style:{marginLeft:"10px"},children:"Export to Excel"}),e.jsx("div",{className:"table-responsive hh mt-3",children:e.jsxs(X,{striped:!0,bordered:!0,hover:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-center",children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"First Name"}),e.jsx("th",{children:"Middle Name"}),e.jsx("th",{children:"Last Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Date of Birth"}),e.jsx("th",{children:"Phone Number"}),e.jsx("th",{children:"Number of Persons"}),e.jsx("th",{children:"Nationality"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:T.map(t=>e.jsxs("tr",{className:"text-center",children:[e.jsx("td",{children:t.idGuest}),e.jsx("td",{children:t.firstName}),e.jsx("td",{children:t.middleName}),e.jsx("td",{children:t.lastName}),e.jsx("td",{children:t.email}),e.jsx("td",{children:t.dateOfBirth}),e.jsx("td",{children:t.phoneNumber}),e.jsx("td",{children:t.numberPersons}),e.jsx("td",{children:t.nationality}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx(d,{variant:"link",onClick:()=>{C(t),c(!0)},title:"Edit",children:e.jsx(M,{icon:Z,style:{fontSize:"1.5rem",color:"orange"}})}),e.jsx(d,{variant:"link",onClick:()=>{q(t.id),u(!0)},title:"Delete",children:e.jsx(M,{icon:ee,style:{fontSize:"1.5rem",color:"red"}})}),e.jsx(d,{variant:"link",onClick:()=>$(t),title:"Add Reservation",children:e.jsx(M,{icon:te,style:{fontSize:"1.5rem",color:"green"}})})]})})]},t.idGuest))})]})}),v&&e.jsx(re,{show:v,handleClose:Y,handleSave:S?K:J,client:S}),_&&e.jsxs(l,{show:_,onHide:()=>u(!1),children:[e.jsx(l.Body,{children:"Are you sure you want to delete this client?"}),e.jsxs(l.Footer,{children:[e.jsx(d,{variant:"secondary",onClick:()=>u(!1),children:"No"}),e.jsx(d,{variant:"danger",onClick:Q,children:"Yes, Delete"})]})]}),F&&e.jsxs(l,{show:F,onHide:()=>f(!1),children:[e.jsx(l.Body,{children:"The client was successfully deleted."}),e.jsx(l.Footer,{children:e.jsx(d,{variant:"primary",onClick:()=>f(!1),children:"Close"})})]}),N&&e.jsxs(l,{show:N,onHide:()=>x(!1),children:[e.jsx(l.Body,{children:"Is this client checked-in?"}),e.jsxs(l.Footer,{children:[e.jsx(d,{variant:"secondary",onClick:()=>R(!1),children:"No"}),e.jsx(d,{variant:"primary",onClick:()=>R(!0),children:"Yes"})]})]}),g&&e.jsx(V,{show:g,handleClose:()=>h(!1),client:p,addReservation:U}),G&&e.jsxs(l,{show:G,onHide:()=>D(!1),children:[e.jsx(l.Body,{children:"The client was successfully added."}),e.jsx(l.Footer,{children:e.jsx(d,{variant:"primary",onClick:()=>D(!1),children:"Close"})})]})]})};export{Ce as default};
