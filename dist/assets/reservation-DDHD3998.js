import{r,J as x,j as e}from"./index-ffYVKfzY.js";import{R as z}from"./reservationform-CsX-nHLZ.js";import{C as S}from"./index.esm-DxGkv9hs.js";/* empty css               */import{u as w,a as H}from"./xlsx-CwztvpuY.js";import{F as $}from"./FileSaver.min-uNC1H6Ye.js";import{B as l,M as d}from"./Modal-DHu8A-az.js";import{T as J}from"./Table-BNWZN0Px.js";import{c as P}from"./cil-pen-53d2I-C-.js";import{c as q}from"./cil-trash-CBbKHhHb.js";import"./index-C9dK0-s5.js";import"./ThemeProvider-BV5dC5GT.js";import"./hasClass-DoSno_Ds.js";const ae=()=>{const[i,h]=r.useState([]),[u,C]=r.useState(""),[p,k]=r.useState(""),[R,v]=r.useState(!1),[c,f]=r.useState(null),[_,m]=r.useState(!1),[N,y]=r.useState(null),b=async()=>{try{const t=await x.get("http://localhost:5000/api/reservations/");h(t.data)}catch(t){console.error("Error loading reservations:",t),alert("An error occurred while fetching reservations.")}},E=t=>{y(t),m(!0)},I=()=>{m(!1),y(null)};r.useEffect(()=>{b()},[]);const j=Array.isArray(i)?i.filter(t=>{const s=new Date(t.dateReserve),a=new Date(u),n=u?s.toDateString()===a.toDateString():!0,g=p?t.guests_id_guest.toString().includes(p):!0;return n&&g}):[],F=t=>{const s=w.book_new(),a=w.json_to_sheet(t.map(o=>({"Reservation ID":o.id,"Client ID":o.guests_id_guest,"Reservation Date":new Date(o.date_reserve).toLocaleDateString(),"Check-In Date":new Date(o.date_checkin).toLocaleDateString(),"Check-Out Date":new Date(o.date_checkout).toLocaleDateString(),"Number of Nights":o.number_nights,"Rooms Assigned":o.rooms?o.rooms.join(", "):"No rooms assigned"})));a["!cols"]=[{wch:15},{wch:10},{wch:15},{wch:15},{wch:15},{wch:15},{wch:25}],w.book_append_sheet(s,a,"Reservations");const n=H(s,{bookType:"xlsx",type:"array"}),g=new Blob([n],{type:"application/octet-stream"});$.saveAs(g,"Reservations.xlsx")},A=async t=>{try{const s=await x.post("http://localhost:5000/api/reservations/",t);h([...i,s.data]),m(!1)}catch(s){console.error("Error adding reservation:",s)}},T=async t=>{try{const s=await x.put(`http://localhost:5000/api/reservations/${t.id}`,t);h(a=>a.map(n=>n.id===t.id?s.data:n)),m(!1)}catch(s){console.error("Error updating reservation:",s)}},M=async t=>{try{await x.delete(`http://localhost:5000/api/reservations/${t}`),h(i.filter(s=>s.id!==t))}catch(s){console.error("Error deleting reservation:",s)}},B=t=>{f(t),v(!0)},D=()=>{f(null),v(!1)},L=async()=>{c&&(await M(c.id),D())},G=t=>{const s=new Date(t.target.value).toISOString().split("T")[0];C(s)},O=t=>{k(t.target.value)};return e.jsxs("div",{children:[e.jsx("h2",{className:"mt-5 bl",children:"Reservations"}),e.jsxs("div",{className:"mb-3 row",children:[e.jsx("div",{className:"col-md-2",children:e.jsx("input",{type:"date",id:"reservationDateFilter",value:u,onChange:G,className:"form-control"})}),e.jsx("div",{className:"col-md-2",children:e.jsx("input",{type:"text",id:"guestIdFilter",value:p,onChange:O,placeholder:"Filter by Guest ID",className:"search-input "})}),e.jsx("div",{className:"col-md-2",children:e.jsx(l,{variant:"success",onClick:()=>F(i),className:"mb-3",children:"Export to Excel"})})]}),e.jsx("div",{className:"table-responsive hh mt-3",children:e.jsxs(J,{striped:!0,bordered:!0,hover:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-center",children:[e.jsx("th",{children:"ID Reservation"}),e.jsx("th",{children:"Client ID"}),e.jsx("th",{children:"Reservation Date"}),e.jsx("th",{children:"Check-In Date"}),e.jsx("th",{children:"Check-Out Date"}),e.jsx("th",{children:"Number of Nights"}),e.jsx("th",{children:"Room Assigned"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:Array.isArray(j)&&j.length>0?j.sort((t,s)=>s.id-t.id).map(t=>e.jsxs("tr",{className:"text-center",children:[e.jsx("td",{children:t.id}),e.jsx("td",{children:t.guests_id_guest}),e.jsx("td",{children:new Date(t.date_reserve).toLocaleDateString()}),e.jsx("td",{children:new Date(t.date_checkin).toLocaleDateString()}),e.jsx("td",{children:new Date(t.date_checkout).toLocaleDateString()}),e.jsx("td",{children:t.number_nights}),e.jsx("td",{children:t.rooms?t.rooms.join(", "):"No rooms assigned"}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx(l,{variant:"link",onClick:()=>E(t),title:"Edit",children:e.jsx(S,{icon:P,style:{fontSize:"1.5rem",color:"orange"}})}),e.jsx(l,{variant:"link",onClick:()=>B(t),title:"Delete",children:e.jsx(S,{icon:q,style:{fontSize:"1.5rem",color:"red"}})})]})})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center",children:"No reservations found."})})})]})}),e.jsx(z,{show:_,handleClose:I,addReservation:A,updateReservation:T,reservation:N}),e.jsxs(d,{show:R,onHide:D,children:[e.jsx(d.Header,{closeButton:!0,children:e.jsx(d.Title,{children:"Confirm Delete"})}),e.jsxs(d.Body,{children:["Are you sure you want to delete the reservation with ID ",e.jsx("strong",{children:c==null?void 0:c.id}),"?"]}),e.jsxs(d.Footer,{children:[e.jsx(l,{variant:"secondary",onClick:D,children:"Cancel"}),e.jsx(l,{variant:"danger",onClick:L,children:"Delete"})]})]})]})};export{ae as default};
