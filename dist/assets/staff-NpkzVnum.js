import{r as c,j as e,J as b}from"./index-ffYVKfzY.js";import{C as k}from"./index.esm-DxGkv9hs.js";import{u as C,a as O}from"./xlsx-CwztvpuY.js";import{F as U}from"./FileSaver.min-uNC1H6Ye.js";import{M as n,B as m}from"./Modal-DHu8A-az.js";import{F as a}from"./Form-CqvpA1Dk.js";import{T as $}from"./Table-BNWZN0Px.js";import{c as J}from"./cil-pen-53d2I-C-.js";import{c as W}from"./cil-trash-CBbKHhHb.js";import"./index-C9dK0-s5.js";import"./ThemeProvider-BV5dC5GT.js";import"./hasClass-DoSno_Ds.js";const K=({show:x,handleClose:p,staff:r,handleSave:N})=>{const[d,f]=c.useState({id_staff:"",name_staff:"",lastname_staff:"",email_staff:"",phone:"",gen:"",rol_staffname:""}),[y,S]=c.useState([]);c.useEffect(()=>{x&&fetch("http://localhost:5000/api/roles/").then(s=>s.json()).then(s=>S(s)).catch(s=>console.error("Error fetching roles:",s)),f(r?{id_staff:r.id_staff||"",name_staff:r.name_staff||"",lastname_staff:r.lastname_staff||"",email_staff:r.email_staff||"",phone:r.phone||"",gen:r.gen||"",rol_staffname:r.rol_staffname||""}:{id_staff:"",name_staff:"",lastname_staff:"",email_staff:"",phone:"",gen:"",rol_staffname:""})},[r,x]);const h=s=>{const{name:v,value:w}=s.target;f({...d,[v]:w})},j=s=>{s.preventDefault(),N(d)};return e.jsxs(n,{show:x,onHide:p,children:[e.jsx(n.Header,{closeButton:!0,children:e.jsx(n.Title,{children:r?"Edit Staff":"Add Staff"})}),e.jsx(n.Body,{children:e.jsxs(a,{onSubmit:j,children:[e.jsxs(a.Group,{controlId:"formId",children:[e.jsx(a.Label,{children:"ID"}),e.jsx(a.Control,{type:"text",name:"id_staff",value:d.id_staff,onChange:h,placeholder:"ID",disabled:!0})]}),e.jsxs(a.Group,{controlId:"formFirstName",children:[e.jsx(a.Label,{children:"First Name"}),e.jsx(a.Control,{type:"text",name:"name_staff",value:d.name_staff,onChange:h,placeholder:"First Name",required:!0})]}),e.jsxs(a.Group,{controlId:"formLastName",children:[e.jsx(a.Label,{children:"Last Name"}),e.jsx(a.Control,{type:"text",name:"lastname_staff",value:d.lastname_staff,onChange:h,placeholder:"Last Name",required:!0})]}),e.jsxs(a.Group,{controlId:"formEmail",children:[e.jsx(a.Label,{children:"Email"}),e.jsx(a.Control,{type:"email",name:"email_staff",value:d.email_staff,onChange:h,placeholder:"Email",required:!0})]}),e.jsxs(a.Group,{controlId:"formPhone",children:[e.jsx(a.Label,{children:"Phone"}),e.jsx(a.Control,{type:"text",name:"phone",value:d.phone,onChange:h,placeholder:"Phone"})]}),e.jsxs(a.Group,{controlId:"formGen",children:[e.jsx(a.Label,{children:"Gender"}),e.jsxs(a.Control,{as:"select",name:"gen",value:d.gen,onChange:h,required:!0,children:[e.jsx("option",{value:"",children:"Select Gender"}),e.jsx("option",{value:"M",children:"Male"}),e.jsx("option",{value:"F",children:"Female"})]})]}),e.jsxs(a.Group,{controlId:"formRole",children:[e.jsx(a.Label,{children:"Role"}),e.jsxs(a.Control,{as:"select",name:"rol_staffname",value:d.rol_staffname,onChange:h,children:[e.jsx("option",{value:"",children:"Select Role"}),y.length>0?y.map(s=>e.jsx("option",{value:s.rol_name,children:s.rol_name},s.id)):e.jsx("option",{children:"Loading roles..."})]})]}),e.jsx(m,{variant:"primary",type:"submit",children:r?"Update":"Add"})]})})]})},le=()=>{const[x,p]=c.useState([]),[r,N]=c.useState([]),[d,f]=c.useState(!1),[y,S]=c.useState(null),[h,j]=c.useState(!1),[s,v]=c.useState(null),[w,F]=c.useState(!1),[_,D]=c.useState(null),I=()=>{b.get("http://localhost:5000/api/staff").then(t=>p(t.data)).catch(t=>console.error("Error loading staff:",t))};c.useEffect(()=>{I()},[]);const B=()=>{S(null),f(!0)},L=()=>{f(!1)},G=t=>{const{id:u,...i}=t;b.post("http://localhost:5000/api/staff",i).then(l=>{p([...x,l.data]),f(!1)}).catch(l=>console.error("Error adding staff:",l))},M=t=>{if(!t.id_staff){console.error("No staff ID found, cannot update");return}b.put(`http://localhost:5000/api/staff/${t.id_staff}`,t).then(u=>{const i=x.map(l=>l.id_staff===t.id_staff?u.data:l);p(i),f(!1)}).catch(u=>console.error("Error updating staff:",u))},A=t=>{v(t),j(!0)},P=()=>{s&&b.delete(`http://localhost:5000/api/staff/${s.id_staff}`).then(()=>{p(x.filter(t=>t.id!==s.id)),j(!1),v(null)}).catch(t=>console.error("Error deleting staff:",t))},R=t=>{D(t),S(t),F(!0)},H=()=>{F(!1),f(!0)},q=t=>{const u=C.book_new(),i=C.json_to_sheet(t.map(o=>({ID:o.idGuest,"First Name":o.firstName,"Middle Name":o.middleName||"","Last Name":o.lastName,Email:o.email,"Date of Birth":o.dateOfBirth,"Phone Number":o.phoneNumber,"Number of Persons":o.numberPersons,Nationality:o.nationality}))),l=C.decode_range(i["!ref"]);for(let o=l.s.c;o<=l.e.c;++o){const g=C.encode_cell({r:0,c:o});i[g]&&(i[g].s={font:{bold:!0,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"4F81BD"}},alignment:{horizontal:"center",vertical:"center"}})}i["!cols"]=[{wch:5},{wch:15},{wch:15},{wch:15},{wch:25},{wch:15},{wch:15},{wch:15},{wch:20}];for(let o=l.s.r;o<=l.e.r;++o)for(let g=l.s.c;g<=l.e.c;++g){const E=C.encode_cell({r:o,c:g});i[E]&&(i[E].s={...i[E].s,border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}})}C.book_append_sheet(u,i,"Clients Data");const T=O(u,{bookType:"xlsx",type:"array"}),z=new Blob([T],{type:"application/octet-stream"});U.saveAs(z,"Clients_Data.xlsx")};return e.jsxs("div",{children:[e.jsx("h2",{children:"Staff Management"}),e.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"10px"},children:[e.jsx(m,{variant:"dark",onClick:B,children:"Add Staff"}),e.jsx(m,{variant:"success",onClick:q,children:"Download Excel"})]}),e.jsx("div",{className:"table-responsive mt-3",children:e.jsxs($,{striped:!0,bordered:!0,hover:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-center",children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"First Name"}),e.jsx("th",{children:"Last Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Phone"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:x.map(t=>e.jsxs("tr",{className:"text-center",children:[e.jsx("td",{children:t.id_staff}),e.jsx("td",{children:t.name_staff}),e.jsx("td",{children:t.lastname_staff}),e.jsx("td",{children:t.email_staff}),e.jsx("td",{children:t.phone}),e.jsx("td",{children:t.rol_staffname||"Unassigned"}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx(m,{variant:"link",onClick:()=>R(t),title:"Edit",children:e.jsx(k,{icon:J,style:{fontSize:"1.5rem",color:"orange"}})}),e.jsx(m,{variant:"link",onClick:()=>A(t),title:"Delete",children:e.jsx(k,{icon:W,style:{fontSize:"1.5rem",color:"red"}})})]})})]},t.id))})]})}),e.jsx(K,{show:d,handleClose:L,staff:y,handleSave:y?M:G,roles:r}),e.jsxs(n,{show:h,onHide:()=>j(!1),children:[e.jsx(n.Header,{closeButton:!0,children:e.jsx(n.Title,{children:"Confirm Deletion"})}),e.jsxs(n.Body,{children:["Are you sure you want to delete ",e.jsxs("strong",{children:[s==null?void 0:s.name_staff," ",s==null?void 0:s.lastname_staff]}),"?"]}),e.jsxs(n.Footer,{children:[e.jsx(m,{variant:"secondary",onClick:()=>j(!1),children:"Cancel"}),e.jsx(m,{variant:"danger",onClick:P,children:"Delete"})]})]}),e.jsxs(n,{show:w,onHide:()=>F(!1),children:[e.jsx(n.Header,{closeButton:!0,children:e.jsx(n.Title,{children:"Confirm Edit"})}),e.jsxs(n.Body,{children:["Are you sure you want to edit ",e.jsxs("strong",{children:[_==null?void 0:_.name_staff," ",_==null?void 0:_.lastname_staff]}),"?"]}),e.jsxs(n.Footer,{children:[e.jsx(m,{variant:"secondary",onClick:()=>F(!1),children:"Cancel"}),e.jsx(m,{variant:"primary",onClick:H,children:"Edit"})]})]})]})};export{le as default};
